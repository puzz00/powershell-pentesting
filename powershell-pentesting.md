# Powershell Fundamentals

## The Powershell Command Line Interface

We can launch the powershell CLI from a cmd prompt by using `powershell.exe`

Once we are in a powershell session, we can find help for commands using `powershell /?` or `powershell -?` or `powershell -Help`

Another way to get help with powershell is by using the `Get-Help` cmdlet. We just need to specify what it is that we want to get help with: `Get-Help Get-Process`

We can get more help on cmdlets by using the `-Full` parameter: `Get-Help Get-Process -Full`

Another useful feature is `-Examples` which provides us with useful examples of how to use cmdlets: `Get-Help Get-Process -Examples`

>[!TIP]
>We can update our local help files using `Update-Help`

### Get-Command

This is a very useful cmdlet which lets us list what is available to us in powershell. If we run it without specifying any arguments it will return a list of *all* available commands.

We can filter the results by using the `-Name` parameter which functions in a similar way to `grep` on unix systems. An example is: `Get-Command -Name *Firewall*`

### Common Powershell Command Line Parameters

Here are some common and useful command line parameters. We can use abbreviations for powershell parameters and their arguments. Furthermore, we can use different casing to that which is shown here since they are not case-sensitive.

#### -ExecutionPolicy

We can specify that the *ExecutionPolicy* be *bypassed* or *unrestricted* when running powershell scripts. The execution policy on powershell is intended to prevent regular users from executing scripts which might cause problems on their system by preventing some scripts from running.

We will want to bypass any execution policies on the system - we can do this using: `powershell.exe -ExecutionPolicy Bypass .\script.ps1` or `powershell.exe -ExecutionPolicy Unrestricted .\script.ps1`

>[!TIP]
>We can abbreviate this parameter to `-ep` or `-ex` and the `Bypass` argument as `by`

#### -WindowStyle

We can hide the powershell window using: `powershell.exe -WindowStyle Hidden .\script.ps1`

This will hide the powershell CLI on the victim machine which will make our work more stealthy.

>[!TIP]
>We can abbreviate this parameter to `-W` or `-Wi` and the `Hidden` argument as `h` or `hi`

#### -Command

This parameter is used to run a command or script block. An example of this is: `powershell.exe -Command Get-Process`

#### -EncodedCommand

This parameter lets us execute commands which have been base64 encoded: `powershell.exe -EncodedCommand $encodedCommand`

>[!TIP]
>We can abbreviate this parameter to `enco` or `ec`

#### -NoProfile

Profiles are scripts which run when the powershell executable is launched. These scripts (profiles) can cause problems when we are trying to execute commands using powershell so it is a good idea to disable them using: `powershell.exe -NoProfile .\script.ps1`

#### -Version

This parameter lets us downgrade to an older version of powershell. This is useful for if we need to use an older version of powershell in order to accomplish what we want: `powershell.exe -Version 2`

>[!NOTE]
>In order for `-Version` to work the specified older version must be installed on the system

